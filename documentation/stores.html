<!doctype html>
<html lang="en">

<meta charset="utf-8">
<title>Fluxxor - Stores</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta content="IE=edge,chrome=1" http-equiv="X-UA-Compatible">
<meta property="og:image" content="http://fluxxor.com/fluxxor.png">
<meta property="og:site_name" content="Fluxxor">
<meta name="twitter:card" content="summary">
<meta name="twitter:site" content="">
<meta name="twitter:title" content="Fluxxor">
<meta name="twitter:description" content="Fluxxor is a set of tools to facilitate building JavaScript data layers using the Flux architecture.">
<meta name="twitter:creator" content="BinaryMuse">
<meta name="twitter:image:src" content="http://fluxxor.com/fluxxor.png">
<meta name="twitter:domain" content="">
<meta name="twitter:app:name:iphone" content="">
<meta name="twitter:app:name:ipad" content="">
<meta name="twitter:app:name:googleplay" content="">
<meta name="twitter:app:url:iphone" content="">
<meta name="twitter:app:url:ipad" content="">
<meta name="twitter:app:url:googleplay" content="">
<meta name="twitter:app:id:iphone" content="">
<meta name="twitter:app:id:ipad" content="">
<meta name="twitter:app:id:googleplay" content="">
<link rel="stylesheet" href="http://yandex.st/highlightjs/8.0/styles/default.min.css">
<script src="http://cdnjs.cloudflare.com/ajax/libs/es5-shim/3.4.0/es5-shim.min.js"></script>
<script src="http://yandex.st/highlightjs/8.0/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>
<link rel="stylesheet" type="text/css" href="/style/main.css">

<a class="github-banner" href="https://github.com/BinaryMuse/fluxxor"><img style="position: fixed; top: 0; right: 0; border: 0;" src="https://camo.githubusercontent.com/a6677b08c955af8400f44c6298f40e7d19cc5b2d/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f72696768745f677261795f3664366436642e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png"></a>

<div class="wrapper">
  <header>
    <div class="logo-container-sidebar">
      <a href="/"><img src="/fluxxor.svg" alt="Fluxxor" title="Fluxxor" class="logo-svg"></a>
    </div>
    <div class="show-hide-nav">
      <a href="#" class="show-nav">Show Navigation</a>
      <a href="#" class="hide-nav">Hide Navigation</a>
    </div>
    <div class="nav-list">
      <ul>
        <li><a href="/">Home</a></li>
        <li><a href="/what-is-flux.html">What is Flux?</a></li>
        <li><a href="/guides/">Guides</a></li>
        <ul>
          <li><a href="/guides/installation.html">Installation</a></li>
          <li><a href="/guides/react.html">Using with React</a></li>
          <li><a href="/guides/quick-start.html">Quick-Start Guide</a></li>
          <li><a href="/guides/async-data.html">Dealing with Asynchronous Data</a></li>
          <li><a href="/guides/routing.html">Routing</a></li>
        </ul>
        <li><a href="/examples/">Examples</a></li>
        <ul>
          <li><a href="/guides/quick-start.html">Basic Todos</a></li>
          <li><a href="/examples/carousel/">Image Carousel</a></li>
          <li><a href="/guides/async-data.html">Asynchronous Data</a></li>
          <li><a href="/examples/react-router.html">React Router</a></li>
        </ul>
        <li><a href="/documentation/">Documentation</a></li>
        <ul>
          <li><a href="/documentation/flux.html">Fluxxor.Flux</a></li>
          <li><a href="/documentation/stores.html">Stores</a></li>
          <li><a href="/documentation/actions.html">Actions</a></li>
          <li><a href="/documentation/flux-mixin.html">Fluxxor.FluxMixin</a></li>
          <li><a href="/documentation/store-watch-mixin.html">Fluxxor.StoreWatchMixin</a></li>
        </ul>
        <li><a href="/faq.html">FAQ</a></li>
        <li><a href="/changelog.html">Changelog</a></li>
        <li><a href="https://github.com/BinaryMuse/fluxxor">View on GitHub</a></li>
      </ul>
      <p>
        <a href="https://gitter.im/BinaryMuse/fluxxor">Support and chat on Gitter</a><br>
        <a href="https://gitter.im/BinaryMuse/fluxxor"><img src="https://badges.gitter.im/BinaryMuse/fluxxor.png"></a>
      </p>
    </div>
    <div class="sidebar-info">
      <hr>
      <p>Copyright &copy; 2014 <a href="https://github.com/BinaryMuse/">Michelle Tilley</a><br>
      Licensed under <a href="http://opensource.org/licenses/MIT">the MIT license</a></p>
    </div>
  </header>
  <section>
    <h1 id="stores">Stores</h1>
<p>In a Flux application, the stores are responsible for managing business logic and data. They&#39;re akin to models or collections in MVC systems, but stores may manage more than a single piece of data or a single collection, as they are responsible for a <em>domain</em> of the application.</p>
<p>The <em>only</em> way to update stores is to send them an action by way of the dispatcher; stores should not have setter methods or properties that allow users to manipulate the store directly. Stores register their intent to respond to certain action types and actions with those types are routed to the appropriate handlers in the stores. Handlers are called with the action&#39;s payload and type as parameters.</p>
<p>Fluxxor supports dependencies between stores when necessary. If a store depends on data from other stores, it can wait for those stores to finish handling the currently dispatched action with the <code>waitFor</code> method.</p>
<p>Action dispatches are synchronous; stores can perform asynchronous updates, but should fire new actions at the end of the asynchronous operation if the rest of the system should be notified of a change in state as a result of the async operation. (Alternatively, perform asynchronous operations in the action methods themselves.) Once a store returns anything (including <code>undefined</code>) from an action handler, that store is considered to be done with that action&#39;s dispatch (unless it calls <code>waitFor</code>).</p>
<p>Stores can be added to a <code>Flux</code> instance programmatically using <code>Flux#addStore</code> or <code>Flux#addStores</code>; see the <a href="/documentation/flux.html">Flux documentation</a> for more details.</p>
<h2 id="-fluxxor-createstore-spec-"><code>Fluxxor.createStore(spec)</code></h2>
<p>Create a new store constructor.</p>
<ul>
<li><code>spec</code> - An object describing the stores created with the returned constructor.</li>
</ul>
<p><code>spec</code> may contain any properties; functions will be automatically bound to the store instance and attached to it, and other properties will simply be attached to it. The following properties of <code>spec</code> behave specially:</p>
<ul>
<li><p><code>actions</code> - An object map of action types to method names. Actions dispatched to the store with the given type will automatically be handled by the method with the corresponding name. Dynamic action types can be bound with the <code>bindActions</code> method. (<code>bindActions</code> is the recommended approach, since you can refer to constants defined elsewhere, which helps catch errors earlier and better supports minification.)</p>
</li>
<li><p><code>initialize(options)</code> - A function that will be called right after a store is instantiated. <code>options</code> is an optional object passed from the constructor.</p>
</li>
</ul>
<p>Example:</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> MyStore = Fluxxor.createStore({
  actions: {
    <span class="string">"ACTION_TYPE"</span>: <span class="string">"handleActionType"</span>
  },

  initialize: <span class="function"><span class="keyword">function</span>(<span class="params">options</span>) </span>{
    <span class="keyword">this</span>.value = options.value;

    <span class="comment">// We could also use this in place of the `actions` hash, above:</span>
    <span class="keyword">this</span>.bindActions(
      <span class="string">"ACTION_TYPE"</span>, <span class="keyword">this</span>.handleActionType
    );
  },

  handleActionType: <span class="function"><span class="keyword">function</span>(<span class="params">payload, type</span>) </span>{
    <span class="comment">// ...</span>
  }
});

<span class="keyword">var</span> myStore = <span class="keyword">new</span> MyStore({value: <span class="number">123</span>});
</code></pre>
<h2 id="-store-flux-"><code>Store#flux</code></h2>
<p>The <a href="/documentation/flux.html">Flux</a> instance this store is contained within.</p>
<h2 id="-store-bindactions-type-handler-"><code>Store#bindActions(type, handler[, ...])</code></h2>
<h2 id="-store-bindactions-actions-"><code>Store#bindActions(actions)</code></h2>
<p>Binds action types to methods on the store.</p>
<p><code>bindActions(type, handler[, ...])</code> takes any even number of arguments:</p>
<ul>
<li><code>type</code> - The action type to bind to.</li>
<li><code>handler</code> - A function reference or method name (as a string) to call when actions of that type are dispatched to the store.</li>
</ul>
<p><code>bindActions(actions)</code> takes an actions hash in the same format as <code>spec.actions</code> described in <code>createStore</code>, above.</p>
<p>Using <code>bindActions</code> with constants defined elsewhere is less error prone and supports minification better than using the <code>actions</code> hash in the <code>createStore</code> spec or passing a hash to <code>bindActions</code>.</p>
<p>Example:</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> ACTION_TYPE = <span class="string">"ACTION_TYPE_1"</span>,
    OTHER_ACTION_TYPE = <span class="string">"ACTION_TYPE_2"</span>;

<span class="keyword">var</span> MyStore = Fluxxor.createStore({
  initialize: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{
    <span class="keyword">this</span>.bindActions(
      ACTION_TYPE, <span class="keyword">this</span>.handleActionType,
      OTHER_ACTION_TYPE, <span class="string">"handleOtherActionType"</span>
    );

    <span class="comment">// OR:</span>

    <span class="keyword">this</span>.bindActions({
      <span class="string">"ACTION_TYPE_1"</span>: <span class="string">"handleActionType"</span>,
      <span class="string">"ACTION_TYPE_2"</span>: <span class="string">"handleOtherActionType"</span>
    });
  },

  handleActionType: <span class="function"><span class="keyword">function</span>(<span class="params">payload, type</span>) </span>{
    <span class="comment">// ...</span>
  },

  handleOtherActionType: <span class="function"><span class="keyword">function</span>(<span class="params">payload, type</span>) </span>{
    <span class="comment">// ...</span>
  }
});
</code></pre>
<h2 id="-store-waitfor-stores-callback-"><code>Store#waitFor(stores, callback)</code></h2>
<p>Waits for other stores to finish dispatching the current action, executing <code>callback</code> afterwards. Since action handlers are synchronous, a store is &quot;finished&quot; handling an action when the handler function returns.</p>
<ul>
<li><code>stores</code> - An array of names of stores to wait for.</li>
<li><code>callback(stores)</code> - A function to call after all the specified stores have handled the current dispatch. The function is called with the store instances (corresponding to the array of names).</li>
</ul>
<p><code>waitFor</code> will throw if it detects circular dependencies among the stores being dispatched to.</p>
<p>Example:</p>
<pre><code class="lang-javascript">Fluxxor.createStore({
  actions: {
    <span class="string">"ACTION_TYPE"</span>: <span class="string">"actionHandler"</span>
  },

  actionHandler: <span class="function"><span class="keyword">function</span>(<span class="params">payload, type</span>) </span>{
    <span class="keyword">this</span>.waitFor([<span class="string">"otherStore"</span>, <span class="string">"anotherStore"</span>], <span class="function"><span class="keyword">function</span>(<span class="params">other, another</span>) </span>{
      <span class="comment">// ...</span>
    });
  }
});
</code></pre>
<p>Note that the callback is called synchronously.</p>
<h2 id="-eventemitter-methods"><code>EventEmitter</code> methods</h2>
<p>Stores are instances of EventEmitters, and thus <a href="http://nodejs.org/api/events.html#events_class_events_eventemitter">inherit all the EventEmitter methods</a>. Most notably, stores should <code>emit</code> an event to notify the views that their data has changed.</p>
<p>The <a href="/documentation/store-watch-mixin.html"><code>StoreWatchMixin</code></a> assists with attaching event handlers to store change events in React applications.</p>
<p>Example:</p>
<pre><code class="lang-javascript"><span class="keyword">var</span> MyStore = Fluxxor.createStore({
  <span class="comment">// ...</span>

  actionHandler: <span class="function"><span class="keyword">function</span>(<span class="params">payload, type</span>) </span>{
    <span class="comment">// some update to the store's data here</span>
    <span class="keyword">this</span>.emit(<span class="string">"change"</span>);
  }
});

<span class="keyword">var</span> myStore = <span class="keyword">new</span> MyStore();

myStore.on(<span class="string">"change"</span>, <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>{
  <span class="comment">// the store has updated its data</span>
});
</code></pre>

    <hr>
    See a typo? Something still not clear?
    <a href="https://github.com/BinaryMuse/fluxxor/issues/new">Report an issue on GitHub</a>.
  </section>

  <div class="footer-info">
    <hr>
    <p>Copyright &copy; 2014 <a href="https://github.com/BinaryMuse/">Michelle Tilley</a><br>
    Licensed under <a href="http://opensource.org/licenses/MIT">the MIT license</a><br>
    <a href="https://github.com/BinaryMuse/fluxxor">Available on GitHub</a></p>
  </div>
</div>

<script>
document.querySelectorAll(".show-nav")[0].addEventListener("click", function(ev) {
  ev.preventDefault();
  document.querySelectorAll(".nav-list")[0].style.display = 'block';
  document.querySelectorAll(".show-nav")[0].style.display = 'none';
  document.querySelectorAll(".hide-nav")[0].style.display = 'block';
});

document.querySelectorAll(".hide-nav")[0].addEventListener("click", function(ev) {
  ev.preventDefault();
  document.querySelectorAll(".nav-list")[0].style.display = 'none';
  document.querySelectorAll(".show-nav")[0].style.display = 'block';
  document.querySelectorAll(".hide-nav")[0].style.display = 'none';
});
</script>

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-51086297-1', 'fluxxor.com');
  ga('require', 'displayfeatures');
  ga('require', 'linkid', 'linkid.js');
  ga('send', 'pageview');
</script>
<script>
  function appendAnchorSymbol(el, id) {
    var anchor = document.createElement("a");
    anchor.setAttribute("href", "#" + id);
    anchor.setAttribute("class", "anchor-symbol");
    anchor.innerHTML = "&para;";
    el.appendChild(anchor);
  }

  var hs = document.querySelectorAll("h1,h2,h3,h4,h5,h6"),
      h, id;
  for (var i = 0; i < hs.length; i++) {
    h = hs[i];
    id = h.getAttribute("id");
    if (id) {
      appendAnchorSymbol(h, id);
    }
  }
</script>

</html>
